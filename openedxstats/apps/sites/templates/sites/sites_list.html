{% extends "base.html" %}

{% block title %} Open edX Sites List {% endblock %}
{% block bootstrap3_extra_head %}
    <style type="text/css">
        .action-button-cell {
            padding-left: 2px;
            padding-right: 2px;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/u/bs/dt-1.10.12/datatables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/u/bs/dt-1.10.12/datatables.min.js"></script>
    <script>
        $(document).ready(function () {
            sitesTable = $('#sites').dataTable({                  // Table sorting
                "lengthMenu": [[10, 25, 50, 100, 500, -1], [10, 25, 50, 100, 500, "All"]]
            });
            $('#mySearchField').keyup(function () {
                    sitesTable.search($(this).val()).draw();
            })
            $('[data-toggle="tooltip"]').tooltip();  // Tooltips
        });
    </script>
    <script>
        $(document).ready(function () {
            $('#mySearchField').html('<input type="text" placeholder="Enter a date" />');
            $('#mySearchField').on('keyup', function() {
                table
                        .columns(5,6)

            })

            });

            // DataTable
            var table = $('#example').DataTable();

            // Apply the search
            table.column()
            table.columns().every(function () {
                var that = this;

                $('input', this.footer()).on('keyup change', function () {
                    if (that.search() !== this.value) {
                        that
                                .search(this.value)
                                .draw();
                    }
                });
            });
        });
    </script>
{% endblock %}
{% block content %}
    <!-- Navbar -->
    {% include "navbar.html" %}
    <!-- Content -->
    <div class="container">
        <table id="sites" class="table table-bordered table-responsive table-sm">
            <thead>
            <tr>
                <th>Site Type</th>
                <th>Name</th>
                <th>Url</th>
                <th>Course Count</th>
                <th>Active Version Start</th>
                <th>Active Version End</th>
                <th>Current Version?</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tfoot>
            <tr>
                <th>Site Type</th>
                <th>Name</th>
                <th>Url</th>
                <th>Course Count</th>
                <th>Active Version Start</th>
                <th>Active Version End</th>
                <th>Current Version?</th>
                <th>Actions</th>
            </tr>
            </tfoot>
            <tbody>
            {% for site in sites_list %}
                <tr>
                    <td style="vertical-align: middle;">{{ site.site_type }}</td>
                    <td style="vertical-align: middle;">{{ site.name }}</td>
                    <td style="vertical-align: middle;"><a href="{{ site.url }}"> {{ site.url }}</a></td>
                    <td style="vertical-align: middle;">{{ site.course_count }}</td>
                    <td style="vertical-align: middle;">{{ site.active_start_date }}</td>
                    <td style="vertical-align: middle;">{{ site.active_end_date }}</td>
                    <td style="vertical-align: middle; width: 1%; text-align: center">
                        {% if site.active_end_date == None %}
                            <span class="glyphicon glyphicon-ok" aria-hidden="true"
                                  style="color: green; font-size: 30px;"></span>
                        {% endif %}
                    </td>
                    <td style="width: 1%; vertical-align: middle;">
                        <table>
                            <tr>
                                <td class="action-button-cell">
                                    <a href="/sites/site_detail/{{ site.pk }}">
                                        <button type="button" class="btn btn-primary" aria-label="Detail"
                                                data-toggle="tooltip" data-placement="bottom" title="Detail">
                                            <span class="glyphicon glyphicon-list" aria-hidden="true"></span>
                                        </button>
                                    </a>
                                </td>
                                {% if site.active_end_date == None %} <!-- Only most recent version has update link -->
                                    <td class="action-button-cell">
                                        <button type="button" class="btn btn-primary" aria-label="Edit"
                                                data-toggle="tooltip" data-placement="bottom" title="Edit">
                                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                                        </button>
                                    </td>
                                {% endif %}
                                <td class="action-button-cell">
                                    <button type="button" class="btn btn-danger" aria-label="Delete"
                                            data-toggle="tooltip" data-placement="bottom" title="Delete">
                                        <span class="glyphicon glyphicon-trash"></span>
                                    </button>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
